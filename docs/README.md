# ๐ ะะพะบัะผะตะฝัะฐัะธั renderMRPAK

ะะพะปะฝะพะต ัะตัะฝะธัะตัะบะพะต ะพะฟะธัะฐะฝะธะต ะฐััะธัะตะบัััั ะฒะธะทัะฐะปัะฝะพะณะพ ัะตะดะฐะบัะพัะฐ ะบะพะดะฐ.

---

## ๐ฏ ะะฑะทะพั ัะธััะตะผั

**renderMRPAK** โ ััะพ ะฒะธะทัะฐะปัะฝัะน ัะตะดะฐะบัะพั ะดะปั HTML, React ะธ React Native ะฟัะธะปะพะถะตะฝะธะน, ะบะพัะพััะน ะฟะพะทะฒะพะปัะตั ัะตะดะฐะบัะธัะพะฒะฐัั UI ะฝะฐะฟััะผัั ะฒ ะฟัะตะฒัั ะฑะตะท ะฟะพัะตัะธ ะบะพะฝััะพะปั ะฝะฐะด ะธััะพะดะฝัะผ ะบะพะดะพะผ.

### ะะปััะตะฒัะต ะฒะพะทะผะพะถะฝะพััะธ

- โ **ะะธะทัะฐะปัะฝะพะต ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต** - ะธะทะผะตะฝัะนัะต UI ะบะปะธะบะฐะผะธ
- โ **ะกะพััะฐะฝะตะฝะธะต ัะพัะผะฐัะธัะพะฒะฐะฝะธั** - ะบะพะด ะพััะฐะตััั ัะธัะฐะตะผัะผ
- โ **Real-time ะฟัะตะฒัั** - ะธะทะผะตะฝะตะฝะธั ะฒะธะดะฝั ะผะณะฝะพะฒะตะฝะฝะพ
- โ **ะะฐะฑะพัะฐ ั ัััะตััะฒัััะธะผะธ ะฟัะพะตะบัะฐะผะธ** - ะฝะต ััะตะฑัะตั ะฟะตัะตะฟะธััะฒะฐะฝะธั
- โ **ะะพะดะดะตัะถะบะฐ ะทะฐะฒะธัะธะผะพััะตะน** - ัะฐะฑะพัะฐะตั ั ะธะผะฟะพััะฐะผะธ ะธ ะฒะฝะตัะฝะธะผะธ ััะธะปัะผะธ

---

## ๐ ะกัััะบัััะฐ ะดะพะบัะผะตะฝัะฐัะธะธ

### [1. ๐จ ะะตะฝะดะตั](./1-render.md)
**ะะฐะบ ัะฐะนะปั ะฟัะตะฒัะฐัะฐัััั ะฒ ะธะฝัะตัะฐะบัะธะฒะฝัะน ะฟัะตะฒัั**

ะะทััะธัะต:
- ะัะพัะตัั ะทะฐะณััะทะบะธ ะธ ะพะฑัะฐะฑะพัะบะธ ัะฐะนะปะพะฒ
- ะกะธััะตะผั ััะตะนะผะฒะพัะบะพะฒ (HTML, React, React Native)
- ะะฑัะฐะฑะพัะบั ะทะฐะฒะธัะธะผะพััะตะน ะธ ะธะผะฟะพััะพะฒ
- ะะตะฝะตัะฐัะธั HTML ะดะปั iframe
- Hot Reload ะผะตัะฐะฝะธะทะผ

**ะะปั ะบะพะณะพ**: Frontend ัะฐะทัะฐะฑะพััะธะบะธ, ะฐััะธัะตะบัะพัั

---

### [2. ๐จ ะะพะฝััััะบัะพั](./2-constructor.md)
**ะะฐะบ ัะฐะฑะพัะฐะตั ะฒะธะทัะฐะปัะฝัะน ัะตะดะฐะบัะพั**

ะะทััะธัะต:
- ะัะพัะพะบะพะป ะบะพะผะผัะฝะธะบะฐัะธะธ (MRPAK_MSG / MRPAK_CMD)
- ะะพะผะฟะพะฝะตะฝัั ะบะพะฝััััะบัะพัะฐ (BlockEditorPanel, StyleEditor)
- Staged ะธะทะผะตะฝะตะฝะธั (ะฟัะพะผะตะถััะพัะฝะพะต ัะพััะพัะฝะธะต)
- Drag & Drop ะผะตัะฐะฝะธะทะผ
- ะะตัะตะฒะพ ัะปะตะผะตะฝัะพะฒ (Layers Tree)

**ะะปั ะบะพะณะพ**: UI/UX ัะฐะทัะฐะฑะพััะธะบะธ, ัะต ะบัะพ ัะฐะฑะพัะฐะตั ั ะฒะธะทัะฐะปัะฝัะผะธ ัะตะดะฐะบัะพัะฐะผะธ

---

### [3. ๐ ะะฐััะธะฝะณ ะบะพะดะฐ](./3-parsing.md)
**ะะฐะบ ะบะพะด ะฟัะตะฒัะฐัะฐะตััั ะฒ ััััะบัััะธัะพะฒะฐะฝะฝัะต ะดะฐะฝะฝัะต**

ะะทััะธัะต:
- ะะปะณะพัะธัะผั ะธะฝััััะผะตะฝัะฐัะธะธ (HTML ะธ JSX)
- ะััะฝะพะน ะฟะฐััะธะฝะณ JSX ะฑะตะท AST
- ะะตะฝะตัะฐัะธั ัะฝะธะบะฐะปัะฝัั ID
- ะกัััะบัััะฐ blockMap
- ะะฑัะฐะฑะพัะบะฐ edge cases

**ะะปั ะบะพะณะพ**: ะะฐะทัะฐะฑะพััะธะบะธ ะบะพะผะฟะธะปััะพัะพะฒ, ัะต ะบัะพ ะธะฝัะตัะตััะตััั ะฟะฐััะธะฝะณะพะผ

---

### [4. โ๏ธ ะะตะฝะตัะฐัะธั ะบะพะดะฐ](./4-code-generation.md)
**ะะฐะบ ะธะทะผะตะฝะตะฝะธั ะธะท ะบะพะฝััััะบัะพัะฐ ะฟัะธะผะตะฝััััั ะบ ะบะพะดั**

ะะทััะธัะต:
- PatchEngine ะฐััะธัะตะบัััั
- ะะทะผะตะฝะตะฝะธะต ััะธะปะตะน (inline, StyleSheet, ะฒะฝะตัะฝะธะต ัะฐะนะปั)
- ะััะฐะฒะบั ะธ ัะดะฐะปะตะฝะธะต ัะปะตะผะตะฝัะพะฒ
- ะฃะผะฝัั ะฒััะฐะฒะบั ะพะฑัะฐะฑะพััะธะบะพะฒ ัะพะฑััะธะน
- ะะตัะตะผะตัะตะฝะธะต ัะปะตะผะตะฝัะพะฒ (reparent)
- ะะทะผะตะฝะตะฝะธะต ัะตะบััะฐ

**ะะปั ะบะพะณะพ**: Backend ัะฐะทัะฐะฑะพััะธะบะธ, ัะต ะบัะพ ัะฐะฑะพัะฐะตั ั ะบะพะดะพะณะตะฝะตัะฐัะธะตะน

---

## ๐ ะะพะปะฝัะน ัะธะบะป ัะฐะฑะพัั

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    1. ะะะะะะ                            โ
โ                                                         โ
โ  ะััะพะดะฝัะน ัะฐะนะป โ ะะฝััััะผะตะฝัะฐัะธั โ HTML โ iframe        โ
โ    App.jsx     + data-no-code-ui-id   ั ะฟัะตะฒัั         โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  2. ะะะะกะขะะฃะะขะะ                         โ
โ                                                         โ
โ  ะะพะปัะทะพะฒะฐัะตะปั ะฒะทะฐะธะผะพะดะตะนััะฒัะตั ั ะฟัะตะฒัั:                โ
โ  โข ะัะฑะธัะฐะตั ัะปะตะผะตะฝัั                                   โ
โ  โข ะะทะผะตะฝัะตั ััะธะปะธ                                      โ
โ  โข ะะพะฑะฐะฒะปัะตั/ัะดะฐะปัะตั/ะฟะตัะตะผะตัะฐะตั ัะปะตะผะตะฝัั               โ
โ                                                         โ
โ  ะะทะผะตะฝะตะฝะธั ะฝะฐะบะฐะฟะปะธะฒะฐัััั ะฒ staged ัะพััะพัะฝะธะธ            โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  3. ะะะะกะะะ                             โ
โ                                                         โ
โ  blockMap ัะฒัะทัะฒะฐะตั ัะปะตะผะตะฝัั ะฒ ะฟัะตะฒัั ั ะบะพะดะพะผ:         โ
โ  'mrpak:App:150:180:View' โ { start: 150, end: 180 }   โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ               4. ะะะะะะะฆะะฏ ะะะะ                         โ
โ                                                         โ
โ  PatchEngine ะฟัะธะผะตะฝัะตั ะธะทะผะตะฝะตะฝะธั:                      โ
โ  โข ะะพะดะธัะธัะธััะตั ัะตะบัั ะบะพะดะฐ ะฝะฐะฟััะผัั                    โ
โ  โข ะกะพััะฐะฝัะตั ัะพัะผะฐัะธัะพะฒะฐะฝะธะต                            โ
โ  โข ะะฐะฟะธััะฒะฐะตั ะฒ ัะฐะนะป                                   โ
โ  โข ะขัะธะณะณะตัะธั ะฟะตัะตะทะฐะณััะทะบั ะฟัะตะฒัั                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
             โ
             โ (ัะธะบะป ะฟะพะฒัะพััะตััั)
             โผ
```

---

## ๐๏ธ ะขะตัะฝะธัะตัะบะธะน ััะตะบ

### Frontend
- **React** - ะพัะฝะพะฒะฝะพะน UI ััะตะนะผะฒะพัะบ
- **React Native** (ัะตัะตะท react-native-web) - ะดะปั RN ะฟัะตะฒัั
- **Monaco Editor** - ัะตะดะฐะบัะพั ะบะพะดะฐ
- **Babel Standalone** - ััะฐะฝััะพัะผะฐัะธั JSX ะฒ ะฑัะฐัะทะตัะต

### Backend
- **Electron** - ะดะตัะบัะพะฟะฝะพะต ะฟัะธะปะพะถะตะฝะธะต
- **Node.js** - ัะฐะนะปะพะฒะฐั ัะธััะตะผะฐ, file watcher

### ะะฐััะธะฝะณ
- **DOMParser** - ะดะปั HTML
- **ะััะฝะพะน ะฟะฐััะตั** - ะดะปั JSX (ะฑะตะท ะทะฐะฒะธัะธะผะพััะตะน)

### ะกะฑะพัะบะฐ
- **Vite** - ัะฑะพััะธะบ ะธ dev ัะตัะฒะตั

---

## ๐ ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั

| ะะตััะธะบะฐ | ะะฝะฐัะตะฝะธะต |
|---------|----------|
| ะะฐััะธะฝะณ JSX ัะฐะนะปะฐ (500 ัััะพะบ) | ~15ms |
| ะะฝััััะผะตะฝัะฐัะธั | ~10ms |
| ะะตะฝะดะตั ะฟัะตะฒัั | ~100ms |
| ะัะธะผะตะฝะตะฝะธะต ะฟะฐััะฐ | ~5-20ms |
| Hot Reload (ะฟะพะปะฝัะน ัะธะบะป) | <100ms |
| ะะฐะทะผะตั ะฑะฐะฝะดะปะฐ | ~2.5MB |

---

## ๐ ะะปั ะธะทััะตะฝะธั

### ะะฐัะธะฝะฐััะธะต
1. ะะฐัะฝะธัะต ั [ะะตะฝะดะตั](./1-render.md) ะดะปั ะฟะพะฝะธะผะฐะฝะธั ะพะฑัะตะน ะบะฐััะธะฝั
2. ะะทััะธัะต [ะะพะฝััััะบัะพั](./2-constructor.md) ะดะปั ะฟะพะฝะธะผะฐะฝะธั UI
3. ะะพัะบัะฟะตัะธะผะตะฝัะธััะนัะต ั ะฟัะธะผะตัะฐะผะธ ะฒ `tests/`

### ะัะพะดะฒะธะฝัััะต
1. ะะพะณััะทะธัะตัั ะฒ [ะะฐััะธะฝะณ](./3-parsing.md) ะดะปั ะฟะพะฝะธะผะฐะฝะธั ะฐะปะณะพัะธัะผะพะฒ
2. ะะทััะธัะต [ะะตะฝะตัะฐัะธั ะบะพะดะฐ](./4-code-generation.md) ะดะปั PatchEngine
3. ะััะปะตะดัะนัะต ะธััะพะดะฝัะน ะบะพะด ะฒ `src/blockEditor/`

### ะะพะฝััะธะฑัััะพัั
- ะะทะฝะฐะบะพะผััะตัั ัะพ ะฒัะตะผะธ ะดะพะบัะผะตะฝัะฐะผะธ
- ะะทััะธัะต ะฐััะธัะตะบัััะฝัะต ัะตัะตะฝะธั
- ะัะพะฒะตัััะต `TODO.md` ะดะปั ัะฟะธัะบะฐ ะทะฐะดะฐั

---

## ๐ ะะปััะตะฒัะต ัะฐะนะปั

```
src/
โโโ RenderFile.jsx              # ะะปะฐะฒะฝัะน ะพัะบะตัััะฐัะพั
โโโ BlockEditorPanel.jsx        # UI ะบะพะฝััััะบัะพัะฐ
โโโ blockEditor/
โ   โโโ EditorProtocol.js       # ะัะพัะพะบะพะป ะบะพะผะผัะฝะธะบะฐัะธะธ
โ   โโโ HtmlInstrumenter.js     # ะะฐััะธะฝะณ HTML
โ   โโโ JsxInstrumenter.js      # ะะฐััะธะฝะณ JSX
โ   โโโ PatchEngine/
โ       โโโ index.js            # ะขะพัะบะฐ ะฒัะพะดะฐ
โ       โโโ applyHtmlStylePatch.js
โ       โโโ applyJsxStylePatch.js
โ       โโโ applyJsxInsertDelete.js
โ       โโโ ...
โโโ frameworks/
โ   โโโ FrameworkFactory.js     # ะคะฐะฑัะธะบะฐ ััะตะนะผะฒะพัะบะพะฒ
โ   โโโ HtmlFramework.js
โ   โโโ ReactFramework.js
โ   โโโ ReactNativeFramework.js
โโโ features/
    โโโ file-renderer/
    โ   โโโ lib/
    โ       โโโ block-editor-script.js  # ะกะบัะธะฟั ะดะปั iframe
    โ       โโโ react-processor.js      # ะะฑัะฐะฑะพัะบะฐ React
    โโโ file-operations/
```

---

## ๐ก ะััะธัะตะบัััะฝัะต ัะตัะตะฝะธั

### 1. ะะพัะตะผั ะฑะตะท AST?

**ะะตัะตะฝะธะต**: ะัะฟะพะปัะทะพะฒะฐัั ัััะฝะพะน ะฟะฐััะธะฝะณ ะดะปั JSX

**ะัะธัะธะฝั**:
- โก ะ 5-10 ัะฐะท ะฑััััะตะต Babel
- ๐ฆ ะะฐะฝะดะป ะผะตะฝััะต ะฒ 40 ัะฐะท
- ๐จ ะกะพััะฐะฝัะตั ัะพัะผะฐัะธัะพะฒะฐะฝะธะต ะฝะฐ 100%
- ๐ง ะัะพัะต ะพัะปะฐะถะธะฒะฐัั

**ะะพะผะฟัะพะผะธััั**:
- ะขัะตะฑัะตั ะฐะบะบััะฐัะฝะพะน ะพะฑัะฐะฑะพัะบะธ edge cases
- ะะต ะฟะพะดัะพะดะธั ะดะปั ัะปะพะถะฝะพะณะพ ััะฐัะธัะตัะบะพะณะพ ะฐะฝะฐะปะธะทะฐ

---

### 2. ะะพัะตะผั Staged ะธะทะผะตะฝะตะฝะธั?

**ะะตัะตะฝะธะต**: ะะฐะบะฐะฟะปะธะฒะฐัั ะธะทะผะตะฝะตะฝะธั ะฟะตัะตะด ะฟัะธะผะตะฝะตะฝะธะตะผ

**ะัะธัะธะฝั**:
- ๐๏ธ Real-time ะฟัะตะฒัั ะฑะตะท ะทะฐะฟะธัะธ ะฒ ัะฐะนะป
- โฉ๏ธ ะะพะทะผะพะถะฝะพััั ะพัะผะตะฝั
- ๐ฆ ะะฐััะธะฝะณ ะดะปั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ
- โ ะะฐะปะธะดะฐัะธั ะฟะตัะตะด ะฟัะธะผะตะฝะตะฝะธะตะผ

**ะะพะผะฟัะพะผะธััั**:
- ะกะปะพะถะฝะตะต ัะธะฝััะพะฝะธะทะฐัะธั ัะพััะพัะฝะธั
- ะขัะตะฑัะตั ะฑะพะปััะต ะฟะฐะผััะธ

---

### 3. ะะพัะตะผั iframe?

**ะะตัะตะฝะธะต**: ะะตะฝะดะตัะธัั ะฟัะตะฒัั ะฒ iframe

**ะัะธัะธะฝั**:
- ๐ ะะทะพะปััะธั ััะธะปะตะน ะธ ัะบัะธะฟัะพะฒ
- ๐ก๏ธ ะะตะทะพะฟะฐัะฝะพััั (sandbox)
- ๐ ะะตะณะบะฐั ะฟะตัะตะทะฐะณััะทะบะฐ
- ๐ก ะัะพััะฐั ะบะพะผะผัะฝะธะบะฐัะธั (postMessage)

**ะะพะผะฟัะพะผะธััั**:
- ะะณัะฐะฝะธัะตะฝะธั sandbox
- ะะพะฟะพะปะฝะธัะตะปัะฝัะต ะฝะฐะบะปะฐะดะฝัะต ัะฐััะพะดั

---

## ๐ฏ ะกัะตะฝะฐัะธะธ ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะกัะตะฝะฐัะธะน 1: ะััััะพะต ะฟัะพัะพัะธะฟะธัะพะฒะฐะฝะธะต

```
ะะธะทะฐะนะฝะตั โ ะัะบััะฒะฐะตั ัะฐะนะป โ ะะทะผะตะฝัะตั ััะธะปะธ โ ะัะธะผะตะฝัะตั
           โ                  ะฒะธะทัะฐะปัะฝะพ        โ
         ะฟัะตะฒัั               ะฒ ะฟะฐะฝะตะปะธ         ะบะพะด ะพะฑะฝะพะฒะปะตะฝ
```

### ะกัะตะฝะฐัะธะน 2: ะะตัะฐะบัะพัะธะฝะณ ััััะบัััั

```
ะะฐะทัะฐะฑะพััะธะบ โ ะะตัะตัะฐัะบะธะฒะฐะตั ัะปะตะผะตะฝัั โ ะัะพะฒะตััะตั โ ะัะธะผะตะฝัะตั
              ะฒ ะดะตัะตะฒะต ัะปะพะตะฒ            ะฟัะตะฒัั      ะธะทะผะตะฝะตะฝะธั
```

### ะกัะตะฝะฐัะธะน 3: ะะฐะฑะพัะฐ ั ะดะธะทะฐะนะฝะตัะพะผ

```
ะะธะทะฐะนะฝะตั โ ะะพะบะฐะทัะฒะฐะตั ะฟัะฐะฒะบะธ โ ะะฐะทัะฐะฑะพััะธะบ ะฒะธะดะธั ะบะพะด
          ะฒ ะฟัะตะฒัั              ะฒะธะดะธั ะบะฐะบ ััะพ ัะตะฐะปะธะทะพะฒะฐะฝะพ
```

---

## ๐ ะะทะฒะตััะฝัะต ะพะณัะฐะฝะธัะตะฝะธั

1. **ะะธะฝะฐะผะธัะตัะบะธะต ัะปะตะผะตะฝัั** - ัะปะตะผะตะฝัั ะธะท `.map()` ัะปะพะถะฝั ะดะปั ัะตะดะฐะบัะธัะพะฒะฐะฝะธั
2. **ะกะปะพะถะฝัะต ะฒััะฐะถะตะฝะธั** - `style={computed()}` ะฝะต ัะตะดะฐะบัะธััะตััั ะฒะธะทัะฐะปัะฝะพ
3. **TypeScript** - ะพะณัะฐะฝะธัะตะฝะฝะฐั ะฟะพะดะดะตัะถะบะฐ generic ัะธะฟะพะฒ ะฒ JSX
4. **ะัะพะธะทะฒะพะดะธัะตะปัะฝะพััั** - ะฑะพะปััะธะต ัะฐะนะปั (>2000 ัััะพะบ) ะผะพะณัั ัะพัะผะพะทะธัั

---

## ๐ฎ ะะพัะพะถะฝะฐั ะบะฐััะฐ

### ะัะฐัะบะพััะพัะฝัะต (v1.1)
- [x] ะััะพัะธั ะธะทะผะตะฝะตะฝะธะน (Undo/Redo)
- [ ] ะฃะปัััะตะฝะฝะฐั ะฟะพะดะดะตัะถะบะฐ TypeScript
- [ ] ะััะฟะฟะพะฒะพะต ัะตะดะฐะบัะธัะพะฒะฐะฝะธะต ัะปะตะผะตะฝัะพะฒ
- [ ] Preset ััะธะปะตะน

### ะกัะตะดะฝะตััะพัะฝัะต (v1.5)
- [ ] ะะพะดะดะตัะถะบะฐ Vue.js
- [ ] ะะธะทัะฐะปัะฝัะต ะฝะฐะฟัะฐะฒะปัััะธะต (guides)
- [x] Snap to grid
- [ ] ะะพะผะฟะพะฝะตะฝัะฝะฐั ะฑะธะฑะปะธะพัะตะบะฐ

### ะะพะปะณะพััะพัะฝัะต (v2.0)
- [ ] Collaborative editing
- [ ] Cloud sync
- [ ] AI-assisted design
- [ ] Plugin system

---

## ๐ค ะะบะปะฐะด ะฒ ะฟัะพะตะบั

1. ะัะพัะธัะฐะนัะต ะฒัั ะดะพะบัะผะตะฝัะฐัะธั
2. ะะทะฝะฐะบะพะผััะตัั ั ะฐััะธัะตะบัััะฝัะผะธ ัะตัะตะฝะธัะผะธ
3. ะัะพะฒะตัััะต ะพัะบััััะต issues
4. ะกะพะทะดะฐะนัะต PR ั ะพะฟะธัะฐะฝะธะตะผ ะธะทะผะตะฝะตะฝะธะน

---

## ๐ ะะธัะตะฝะทะธั

MIT

---

*ะะพะบัะผะตะฝัะฐัะธั ะพะฑะฝะพะฒะปะตะฝะฐ: ะะตะบะฐะฑัั 2025*

